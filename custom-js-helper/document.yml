head: |
  <script>
    const jsFile = '/assets/custom.js';
    fetch(jsFile, { method: 'HEAD' })
      .then(async (response) => {
        const lastModified = response.headers.get('Last-Modified');
        if (!lastModified) {
          console.error('Last-Modified header not found.');
          return;
        }
        const timestamp = new Date(lastModified).getTime();
        const script = document.createElement('script');
        script.src = `${jsFile}?v=${timestamp}`;

        console.log("Waiting for Glance...");
        while (!document.body.classList.contains('page-columns-transitioned')) {
            await new Promise(resolve => setTimeout(resolve, 50));
        }

        script.onload = () => loadScript(timestamp);
        document.head.appendChild(script);
      })
      .catch(error => {
        console.error('Error fetching the script:', error);
      });
  </script>